# Домашнее задание к занятию "12.3 Развертывание кластера на собственных серверах, лекция 1"
## Задание 1: Описать требования к кластеру
> Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:
> 
> - база данных должна быть отказоустойчивой (не менее трех копий, master-slave) и потребляет около 4 ГБ ОЗУ в работе;
> - кэш должен быть аналогично отказоустойчивый, более трех копий, потребление: 4 ГБ ОЗУ, 1 ядро;
> - фронтенд обрабатывает внешние запросы быстро, отдавая статику: не более 50 МБ ОЗУ на каждый экземпляр;
> - бекенду требуется больше: порядка 600 МБ ОЗУ и по 1 ядру на копию.
> 
> Требования: опишите, сколько нод в кластере и сколько ресурсов (ядра, ОЗУ, диск) нужно для запуска приложения. Расчет вести из необходимости запуска 5 копий фронтенда и 10 копий бекенда, база и кеш.

Общее количество ресурсов, необходимых для работы Приложения:
|    Компонент  | Кол-во        | CPU           | Память        | CPU total     | Memory total  |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| DB            |  3            | 1             | 4             | 3  | 12  |
| Cache         |  3            | 1             | 4             | 3  | 12  |
| Front         |  5            | 0.2           | 0.05          | 1  | 0.25  |
| Back          |  10           | 1             | 0.6           | 10  | 6  |
| Work node     |  3            | 1             | 1             | 3  | 3  |
| Итого     |  -           | -             | -            | 20  | 33,25  |

Допустим, в целях производительности/отказоусточивости мы хотим три рабочие ноды. Тогда на каждую из них придётся примерно треть требуемых ресурсов. Но вдруг одна нода сломается? тогда ресурсы с неё должны быть перераспределены между двумя выжившими, и мы должны оставить необходимый запас.
Итак, на каждой ноде мы должны зарезервировать на нужды Приложения:

- CPU 20/3*1.5=10
- RAM 33,25/3*1.5=16,625 Gb. Округляем до целого 17 Gb
- Итого с учетом роста производительности и на случай падение/обслуживание одной из нод, закладываем следующие ресурсы для каждой ноды - CPU - 12, RAM - 24 Gb.

Плюс делаем отдельную виртуалку для Control Plane - CPU - 2, RAM - 2 Gb.
